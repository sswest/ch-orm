<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ref</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="class-reference">Class Reference</h1>
<h2 id="infi.clickhouse_orm.database">infi.clickhouse_orm.database</h2>
<h3 id="database">Database</h3>
<h4
id="databasedb_name-db_urlhttplocalhost8123-usernamenone-passwordnone-readonlyfalse">Database(db_name,
db_url=“http://localhost:8123/”, username=None, password=None,
readonly=False)</h4>
<p>Initializes a database instance. Unless it’s readonly, the database
will be created on the ClickHouse server if it does not already
exist.</p>
<ul>
<li><code>db_name</code>: name of the database to connect to.</li>
<li><code>db_url</code>: URL of the ClickHouse server.</li>
<li><code>username</code>: optional connection credentials.</li>
<li><code>password</code>: optional connection credentials.</li>
<li><code>readonly</code>: use a read-only connection.</li>
</ul>
<h4 id="countmodel_class-conditionsnone">count(model_class,
conditions=None)</h4>
<p>Counts the number of records in the model’s table.</p>
<ul>
<li><code>model_class</code>: the model to count.</li>
<li><code>conditions</code>: optional SQL conditions (contents of the
WHERE clause).</li>
</ul>
<h4 id="create_database">create_database()</h4>
<p>Creates the database on the ClickHouse server if it does not already
exist.</p>
<h4 id="create_tablemodel_class">create_table(model_class)</h4>
<p>Creates a table for the given model class, if it does not exist
already.</p>
<h4 id="drop_database">drop_database()</h4>
<p>Deletes the database on the ClickHouse server.</p>
<h4 id="drop_tablemodel_class">drop_table(model_class)</h4>
<p>Drops the database table of the given model class, if it exists.</p>
<h4 id="insertmodel_instances-batch_size1000">insert(model_instances,
batch_size=1000)</h4>
<p>Insert records into the database.</p>
<ul>
<li><code>model_instances</code>: any iterable containing instances of a
single model class.</li>
<li><code>batch_size</code>: number of records to send per chunk (use a
lower number if your records are very large).</li>
</ul>
<h4
id="migratemigrations_package_name-up_to9999">migrate(migrations_package_name,
up_to=9999)</h4>
<p>Executes schema migrations.</p>
<ul>
<li><code>migrations_package_name</code> - fully qualified name of the
Python package containing the migrations.</li>
<li><code>up_to</code> - number of the last migration to apply.</li>
</ul>
<h4
id="paginatemodel_class-order_by-page_num1-page_size100-conditionsnone-settingsnone">paginate(model_class,
order_by, page_num=1, page_size=100, conditions=None,
settings=None)</h4>
<p>Selects records and returns a single page of model instances.</p>
<ul>
<li><code>model_class</code>: the model class matching the query’s
table, or <code>None</code> for getting back instances of an ad-hoc
model.</li>
<li><code>order_by</code>: columns to use for sorting the query
(contents of the ORDER BY clause).</li>
<li><code>page_num</code>: the page number (1-based), or -1 to get the
last page.</li>
<li><code>page_size</code>: number of records to return per page.</li>
<li><code>conditions</code>: optional SQL conditions (contents of the
WHERE clause).</li>
<li><code>settings</code>: query settings to send as HTTP GET
parameters</li>
</ul>
<p>The result is a namedtuple containing <code>objects</code> (list),
<code>number_of_objects</code>, <code>pages_total</code>,
<code>number</code> (of the current page), and
<code>page_size</code>.</p>
<h4 id="rawquery-settingsnone-streamfalse">raw(query, settings=None,
stream=False)</h4>
<p>Performs a query and returns its output as text.</p>
<ul>
<li><code>query</code>: the SQL query to execute.</li>
<li><code>settings</code>: query settings to send as HTTP GET
parameters</li>
<li><code>stream</code>: if true, the HTTP response from ClickHouse will
be streamed.</li>
</ul>
<h4 id="selectquery-model_classnone-settingsnone">select(query,
model_class=None, settings=None)</h4>
<p>Performs a query and returns a generator of model instances.</p>
<ul>
<li><code>query</code>: the SQL query to execute.</li>
<li><code>model_class</code>: the model class matching the query’s
table, or <code>None</code> for getting back instances of an ad-hoc
model.</li>
<li><code>settings</code>: query settings to send as HTTP GET
parameters</li>
</ul>
<h3 id="databaseexception">DatabaseException</h3>
<p>Extends Exception</p>
<p>Raised when a database operation fails.</p>
<h2 id="infi.clickhouse_orm.models">infi.clickhouse_orm.models</h2>
<h3 id="model">Model</h3>
<p>A base class for ORM models.</p>
<h4 id="modelkwargs">Model(**kwargs)</h4>
<p>Creates a model instance, using keyword arguments as field values.
Since values are immediately converted to their Pythonic type, invalid
values will cause a <code>ValueError</code> to be raised. Unrecognized
field names will cause an <code>AttributeError</code>.</p>
<h4 id="model.create_table_sqldb">Model.create_table_sql(db)</h4>
<p>Returns the SQL command for creating a table for this model.</p>
<h4 id="model.drop_table_sqldb">Model.drop_table_sql(db)</h4>
<p>Returns the SQL command for deleting this model’s table.</p>
<h4
id="model.from_tsvline-field_namesnone-timezone_in_useutc-databasenone">Model.from_tsv(line,
field_names=None, timezone_in_use=UTC, database=None)</h4>
<p>Create a model instance from a tab-separated line. The line may or
may not include a newline. The <code>field_names</code> list must match
the fields defined in the model, but does not have to include all of
them. If omitted, it is assumed to be the names of all fields in the
model, in order of definition.</p>
<ul>
<li><code>line</code>: the TSV-formatted data.</li>
<li><code>field_names</code>: names of the model fields in the
data.</li>
<li><code>timezone_in_use</code>: the timezone to use when parsing dates
and datetimes.</li>
<li><code>database</code>: if given, sets the database that this
instance belongs to.</li>
</ul>
<h4 id="get_database">get_database()</h4>
<p>Gets the <code>Database</code> that this model instance belongs to.
Returns <code>None</code> unless the instance was read from the database
or written to it.</p>
<h4 id="get_fieldname">get_field(name)</h4>
<p>Gets a <code>Field</code> instance given its name, or
<code>None</code> if not found.</p>
<h4 id="model.objects_indatabase">Model.objects_in(database)</h4>
<p>Returns a <code>QuerySet</code> for selecting instances of this model
class.</p>
<h4 id="set_databasedb">set_database(db)</h4>
<p>Sets the <code>Database</code> that this model instance belongs to.
This is done automatically when the instance is read from the database
or written to it.</p>
<h4 id="model.table_name">Model.table_name()</h4>
<p>Returns the model’s database table name. By default this is the class
name converted to lowercase. Override this if you want to use a
different table name.</p>
<h4
id="to_dictinclude_readonlytrue-field_namesnone">to_dict(include_readonly=True,
field_names=None)</h4>
<p>Returns the instance’s column values as a dict.</p>
<ul>
<li><code>include_readonly</code>: if false, returns only fields that
can be inserted into database.</li>
<li><code>field_names</code>: an iterable of field names to return
(optional)</li>
</ul>
<h4 id="to_tsvinclude_readonlytrue">to_tsv(include_readonly=True)</h4>
<p>Returns the instance’s column values as a tab-separated line. A
newline is not included.</p>
<ul>
<li><code>include_readonly</code>: if false, returns only fields that
can be inserted into database.</li>
</ul>
<h3 id="buffermodel">BufferModel</h3>
<p>Extends Model</p>
<h4 id="buffermodelkwargs">BufferModel(**kwargs)</h4>
<p>Creates a model instance, using keyword arguments as field values.
Since values are immediately converted to their Pythonic type, invalid
values will cause a <code>ValueError</code> to be raised. Unrecognized
field names will cause an <code>AttributeError</code>.</p>
<h4
id="buffermodel.create_table_sqldb">BufferModel.create_table_sql(db)</h4>
<p>Returns the SQL command for creating a table for this model.</p>
<h4
id="buffermodel.drop_table_sqldb">BufferModel.drop_table_sql(db)</h4>
<p>Returns the SQL command for deleting this model’s table.</p>
<h4
id="buffermodel.from_tsvline-field_namesnone-timezone_in_useutc-databasenone">BufferModel.from_tsv(line,
field_names=None, timezone_in_use=UTC, database=None)</h4>
<p>Create a model instance from a tab-separated line. The line may or
may not include a newline. The <code>field_names</code> list must match
the fields defined in the model, but does not have to include all of
them. If omitted, it is assumed to be the names of all fields in the
model, in order of definition.</p>
<ul>
<li><code>line</code>: the TSV-formatted data.</li>
<li><code>field_names</code>: names of the model fields in the
data.</li>
<li><code>timezone_in_use</code>: the timezone to use when parsing dates
and datetimes.</li>
<li><code>database</code>: if given, sets the database that this
instance belongs to.</li>
</ul>
<h4 id="get_database-1">get_database()</h4>
<p>Gets the <code>Database</code> that this model instance belongs to.
Returns <code>None</code> unless the instance was read from the database
or written to it.</p>
<h4 id="get_fieldname-1">get_field(name)</h4>
<p>Gets a <code>Field</code> instance given its name, or
<code>None</code> if not found.</p>
<h4
id="buffermodel.objects_indatabase">BufferModel.objects_in(database)</h4>
<p>Returns a <code>QuerySet</code> for selecting instances of this model
class.</p>
<h4 id="set_databasedb-1">set_database(db)</h4>
<p>Sets the <code>Database</code> that this model instance belongs to.
This is done automatically when the instance is read from the database
or written to it.</p>
<h4 id="buffermodel.table_name">BufferModel.table_name()</h4>
<p>Returns the model’s database table name. By default this is the class
name converted to lowercase. Override this if you want to use a
different table name.</p>
<h4
id="to_dictinclude_readonlytrue-field_namesnone-1">to_dict(include_readonly=True,
field_names=None)</h4>
<p>Returns the instance’s column values as a dict.</p>
<ul>
<li><code>include_readonly</code>: if false, returns only fields that
can be inserted into database.</li>
<li><code>field_names</code>: an iterable of field names to return
(optional)</li>
</ul>
<h4 id="to_tsvinclude_readonlytrue-1">to_tsv(include_readonly=True)</h4>
<p>Returns the instance’s column values as a tab-separated line. A
newline is not included.</p>
<ul>
<li><code>include_readonly</code>: if false, returns only fields that
can be inserted into database.</li>
</ul>
<h2 id="infi.clickhouse_orm.fields">infi.clickhouse_orm.fields</h2>
<h3 id="field">Field</h3>
<p>Abstract base class for all field types.</p>
<h4 id="fielddefaultnone-aliasnone-materializednone">Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="stringfield">StringField</h3>
<p>Extends Field</p>
<h4
id="stringfielddefaultnone-aliasnone-materializednone">StringField(default=None,
alias=None, materialized=None)</h4>
<h3 id="datefield">DateField</h3>
<p>Extends Field</p>
<h4
id="datefielddefaultnone-aliasnone-materializednone">DateField(default=None,
alias=None, materialized=None)</h4>
<h3 id="datetimefield">DateTimeField</h3>
<p>Extends Field</p>
<h4
id="datetimefielddefaultnone-aliasnone-materializednone">DateTimeField(default=None,
alias=None, materialized=None)</h4>
<h3 id="baseintfield">BaseIntField</h3>
<p>Extends Field</p>
<p>Abstract base class for all integer-type fields.</p>
<h4
id="baseintfielddefaultnone-aliasnone-materializednone">BaseIntField(default=None,
alias=None, materialized=None)</h4>
<h3 id="basefloatfield">BaseFloatField</h3>
<p>Extends Field</p>
<p>Abstract base class for all float-type fields.</p>
<h4
id="basefloatfielddefaultnone-aliasnone-materializednone">BaseFloatField(default=None,
alias=None, materialized=None)</h4>
<h3 id="baseenumfield">BaseEnumField</h3>
<p>Extends Field</p>
<p>Abstract base class for all enum-type fields.</p>
<h4
id="baseenumfieldenum_cls-defaultnone-aliasnone-materializednone">BaseEnumField(enum_cls,
default=None, alias=None, materialized=None)</h4>
<h3 id="arrayfield">ArrayField</h3>
<p>Extends Field</p>
<h4
id="arrayfieldinner_field-defaultnone-aliasnone-materializednone">ArrayField(inner_field,
default=None, alias=None, materialized=None)</h4>
<h3 id="fixedstringfield">FixedStringField</h3>
<p>Extends StringField</p>
<h4
id="fixedstringfieldlength-defaultnone-aliasnone-materializednone">FixedStringField(length,
default=None, alias=None, materialized=None)</h4>
<h3 id="uint8field">UInt8Field</h3>
<p>Extends BaseIntField</p>
<h4
id="uint8fielddefaultnone-aliasnone-materializednone">UInt8Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="uint16field">UInt16Field</h3>
<p>Extends BaseIntField</p>
<h4
id="uint16fielddefaultnone-aliasnone-materializednone">UInt16Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="uint32field">UInt32Field</h3>
<p>Extends BaseIntField</p>
<h4
id="uint32fielddefaultnone-aliasnone-materializednone">UInt32Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="uint64field">UInt64Field</h3>
<p>Extends BaseIntField</p>
<h4
id="uint64fielddefaultnone-aliasnone-materializednone">UInt64Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="int8field">Int8Field</h3>
<p>Extends BaseIntField</p>
<h4
id="int8fielddefaultnone-aliasnone-materializednone">Int8Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="int16field">Int16Field</h3>
<p>Extends BaseIntField</p>
<h4
id="int16fielddefaultnone-aliasnone-materializednone">Int16Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="int32field">Int32Field</h3>
<p>Extends BaseIntField</p>
<h4
id="int32fielddefaultnone-aliasnone-materializednone">Int32Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="int64field">Int64Field</h3>
<p>Extends BaseIntField</p>
<h4
id="int64fielddefaultnone-aliasnone-materializednone">Int64Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="float32field">Float32Field</h3>
<p>Extends BaseFloatField</p>
<h4
id="float32fielddefaultnone-aliasnone-materializednone">Float32Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="float64field">Float64Field</h3>
<p>Extends BaseFloatField</p>
<h4
id="float64fielddefaultnone-aliasnone-materializednone">Float64Field(default=None,
alias=None, materialized=None)</h4>
<h3 id="enum8field">Enum8Field</h3>
<p>Extends BaseEnumField</p>
<h4
id="enum8fieldenum_cls-defaultnone-aliasnone-materializednone">Enum8Field(enum_cls,
default=None, alias=None, materialized=None)</h4>
<h3 id="enum16field">Enum16Field</h3>
<p>Extends BaseEnumField</p>
<h4
id="enum16fieldenum_cls-defaultnone-aliasnone-materializednone">Enum16Field(enum_cls,
default=None, alias=None, materialized=None)</h4>
<h2 id="infi.clickhouse_orm.engines">infi.clickhouse_orm.engines</h2>
<h3 id="engine">Engine</h3>
<h3 id="tinylog">TinyLog</h3>
<p>Extends Engine</p>
<h3 id="log">Log</h3>
<p>Extends Engine</p>
<h3 id="memory">Memory</h3>
<p>Extends Engine</p>
<h3 id="mergetree">MergeTree</h3>
<p>Extends Engine</p>
<h4
id="mergetreedate_col-key_cols-sampling_exprnone-index_granularity8192-replica_table_pathnone-replica_namenone">MergeTree(date_col,
key_cols, sampling_expr=None, index_granularity=8192,
replica_table_path=None, replica_name=None)</h4>
<h3 id="buffer">Buffer</h3>
<p>Extends Engine</p>
<p>Here we define Buffer engine Read more here
https://clickhouse.tech/reference_en.html#Buffer</p>
<h4
id="buffermain_model-num_layers16-min_time10-max_time100-min_rows10000-max_rows1000000-min_bytes10000000-max_bytes100000000">Buffer(main_model,
num_layers=16, min_time=10, max_time=100, min_rows=10000,
max_rows=1000000, min_bytes=10000000, max_bytes=100000000)</h4>
<h3 id="collapsingmergetree">CollapsingMergeTree</h3>
<p>Extends MergeTree</p>
<h4
id="collapsingmergetreedate_col-key_cols-sign_col-sampling_exprnone-index_granularity8192-replica_table_pathnone-replica_namenone">CollapsingMergeTree(date_col,
key_cols, sign_col, sampling_expr=None, index_granularity=8192,
replica_table_path=None, replica_name=None)</h4>
<h3 id="summingmergetree">SummingMergeTree</h3>
<p>Extends MergeTree</p>
<h4
id="summingmergetreedate_col-key_cols-summing_colsnone-sampling_exprnone-index_granularity8192-replica_table_pathnone-replica_namenone">SummingMergeTree(date_col,
key_cols, summing_cols=None, sampling_expr=None, index_granularity=8192,
replica_table_path=None, replica_name=None)</h4>
<h3 id="replacingmergetree">ReplacingMergeTree</h3>
<p>Extends MergeTree</p>
<h4
id="replacingmergetreedate_col-key_cols-ver_colnone-sampling_exprnone-index_granularity8192-replica_table_pathnone-replica_namenone">ReplacingMergeTree(date_col,
key_cols, ver_col=None, sampling_expr=None, index_granularity=8192,
replica_table_path=None, replica_name=None)</h4>
<h2 id="infi.clickhouse_orm.query">infi.clickhouse_orm.query</h2>
<h3 id="queryset">QuerySet</h3>
<h4 id="querysetmodel_cls-database">QuerySet(model_cls, database)</h4>
<h4
id="conditions_as_sqlprewheretrue">conditions_as_sql(prewhere=True)</h4>
<p>Return the contents of the queryset’s WHERE or <code>PREWHERE</code>
clause.</p>
<h4 id="count">count()</h4>
<p>Returns the number of matching model instances.</p>
<h4 id="excludekwargs">exclude(**kwargs)</h4>
<p>Returns a new QuerySet instance that excludes all rows matching the
conditions.</p>
<h4 id="filterkwargs">filter(**kwargs)</h4>
<p>Returns a new QuerySet instance that includes only rows matching the
conditions.</p>
<h4 id="onlyfield_names">only(*field_names)</h4>
<p>Limit the query to return only the specified field names. Useful when
there are large fields that are not needed, or for creating a subquery
to use with an IN operator.</p>
<h4 id="order_byfield_names">order_by(*field_names)</h4>
<p>Returns a new QuerySet instance with the ordering changed.</p>
<h4 id="order_by_as_sql">order_by_as_sql()</h4>
<p>Return the contents of the queryset’s ORDER BY clause.</p>
<h4 id="query">query()</h4>
<p>Return the the queryset as SQL.</p>
</body>
</html>
